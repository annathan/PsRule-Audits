[
  {
    "RuleName": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
    "RunId": "24e28168a75b920d3e02760e6947e1219673acb5",
    "Ref": null,
    "Level": 1,
    "Outcome": "Fail",
    "OutcomeReason": "Processed",
    "Reason": [
      "Essential 8 requires MFA for all users to protect against credential theft",
      "User 'AndrewNathan@camnetcybersecurity.com.au' does not have MFA enabled"
    ],
    "TargetName": "f050417f39de8aa956075e9b4618b0b74458c7fc",
    "TargetType": "System.Management.Automation.PSCustomObject",
    "Data": null,
    "Field": null,
    "Tag": {
      "E8": "E8-7",
      "Category": "Multi-Factor Authentication",
      "MaturityLevel": "ML1",
      "Severity": "Critical"
    },
    "Info": {
      "Name": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
      "DisplayName": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
      "ModuleName": null,
      "Synopsis": null,
      "Description": null,
      "Recommendation": "Multi-factor authentication should be enabled for all users",
      "Annotations": null
    },
    "Time": 14,
    "Error": null,
    "Source": [
      {
        "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\Essential8-Data\\aad.users.json",
        "Line": 2,
        "Position": 22,
        "Type": "File"
      }
    ],
    "Detail": {},
    "Extent": {
      "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\rules\\Azure\\Essential8.MultiFactorAuthentication.Rule.ps1",
      "Line": 8,
      "Position": 1
    },
    "Recommendation": "Multi-factor authentication should be enabled for all users",
    "TargetObject": {
      "UserPrincipalName": "AndrewNathan@camnetcybersecurity.com.au",
      "StrongAuthenticationRequirements": null,
      "AssignedLicenses": null
    },
    "RuleId": ".\\Essential8.E8-7.AzureAD.MFA.AllUsersEnabled"
  },
  {
    "RuleName": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
    "RunId": "0914f16a1b2be2c7871fe9def28e3a5635ff5b66",
    "Ref": null,
    "Level": 1,
    "Outcome": "Pass",
    "OutcomeReason": "Processed",
    "Reason": null,
    "TargetName": "9f98546a36f77b2dbb503621624e22d342f86137",
    "TargetType": "System.Management.Automation.PSCustomObject",
    "Data": null,
    "Field": null,
    "Tag": {
      "E8": "E8-7",
      "Category": "Multi-Factor Authentication",
      "MaturityLevel": "ML1",
      "Severity": "Critical"
    },
    "Info": {
      "Name": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
      "DisplayName": "Essential8.E8-7.AzureAD.MFA.AllUsersEnabled",
      "ModuleName": null,
      "Synopsis": null,
      "Description": null,
      "Recommendation": "Multi-factor authentication should be enabled for all users",
      "Annotations": null
    },
    "Time": 4,
    "Error": null,
    "Source": [
      {
        "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\Essential8-Data\\aad.user.enforced.json",
        "Line": 2,
        "Position": 22,
        "Type": "File"
      }
    ],
    "Detail": {},
    "Extent": {
      "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\rules\\Azure\\Essential8.MultiFactorAuthentication.Rule.ps1",
      "Line": 8,
      "Position": 1
    },
    "Recommendation": "Multi-factor authentication should be enabled for all users",
    "TargetObject": {
      "UserPrincipalName": "admin@contoso.com",
      "StrongAuthenticationRequirements": [
        {
          "State": "Enforced"
        }
      ],
      "StrongAuthenticationMethods": [
        {
          "MethodType": "AuthenticatorApp",
          "IsDefault": true
        }
      ],
      "AssignedRoles": [
        {
          "DisplayName": "Global Administrator"
        }
      ]
    },
    "RuleId": ".\\Essential8.E8-7.AzureAD.MFA.AllUsersEnabled"
  },
  {
    "RuleName": "Essential8.E8-7.AzureAD.MFA.PrivilegedEnforced",
    "RunId": "0914f16a1b2be2c7871fe9def28e3a5635ff5b66",
    "Ref": null,
    "Level": 1,
    "Outcome": "Pass",
    "OutcomeReason": "Processed",
    "Reason": null,
    "TargetName": "9f98546a36f77b2dbb503621624e22d342f86137",
    "TargetType": "System.Management.Automation.PSCustomObject",
    "Data": null,
    "Field": null,
    "Tag": {
      "E8": "E8-7",
      "Category": "Multi-Factor Authentication",
      "MaturityLevel": "ML1",
      "Severity": "Critical"
    },
    "Info": {
      "Name": "Essential8.E8-7.AzureAD.MFA.PrivilegedEnforced",
      "DisplayName": "Essential8.E8-7.AzureAD.MFA.PrivilegedEnforced",
      "ModuleName": null,
      "Synopsis": null,
      "Description": null,
      "Recommendation": "Privileged accounts must have MFA enforced, not just enabled",
      "Annotations": null
    },
    "Time": 5,
    "Error": null,
    "Source": [
      {
        "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\Essential8-Data\\aad.user.enforced.json",
        "Line": 2,
        "Position": 22,
        "Type": "File"
      }
    ],
    "Detail": {},
    "Extent": {
      "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\rules\\Azure\\Essential8.MultiFactorAuthentication.Rule.ps1",
      "Line": 52,
      "Position": 1
    },
    "Recommendation": "Privileged accounts must have MFA enforced, not just enabled",
    "TargetObject": {
      "UserPrincipalName": "admin@contoso.com",
      "StrongAuthenticationRequirements": [
        {
          "State": "Enforced"
        }
      ],
      "StrongAuthenticationMethods": [
        {
          "MethodType": "AuthenticatorApp",
          "IsDefault": true
        }
      ],
      "AssignedRoles": [
        {
          "DisplayName": "Global Administrator"
        }
      ]
    },
    "RuleId": ".\\Essential8.E8-7.AzureAD.MFA.PrivilegedEnforced"
  },
  {
    "RuleName": "Essential8.E8-7.AzureAD.MFA.PhishingResistant",
    "RunId": "0914f16a1b2be2c7871fe9def28e3a5635ff5b66",
    "Ref": null,
    "Level": 1,
    "Outcome": "Pass",
    "OutcomeReason": "Processed",
    "Reason": null,
    "TargetName": "9f98546a36f77b2dbb503621624e22d342f86137",
    "TargetType": "System.Management.Automation.PSCustomObject",
    "Data": null,
    "Field": null,
    "Tag": {
      "E8": "E8-7",
      "Category": "Multi-Factor Authentication",
      "MaturityLevel": "ML2",
      "Severity": "Medium"
    },
    "Info": {
      "Name": "Essential8.E8-7.AzureAD.MFA.PhishingResistant",
      "DisplayName": "Essential8.E8-7.AzureAD.MFA.PhishingResistant",
      "ModuleName": null,
      "Synopsis": null,
      "Description": null,
      "Recommendation": "Users should use phishing-resistant MFA methods (Authenticator app, FIDO2, Windows Hello)",
      "Annotations": null
    },
    "Time": 4,
    "Error": null,
    "Source": [
      {
        "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\Essential8-Data\\aad.user.enforced.json",
        "Line": 2,
        "Position": 22,
        "Type": "File"
      }
    ],
    "Detail": {},
    "Extent": {
      "File": "C:\\Users\\AndrewNathanE²\\Github\\PsRule-Audits\\rules\\Azure\\Essential8.MultiFactorAuthentication.Rule.ps1",
      "Line": 112,
      "Position": 1
    },
    "Recommendation": "Users should use phishing-resistant MFA methods (Authenticator app, FIDO2, Windows Hello)",
    "TargetObject": {
      "UserPrincipalName": "admin@contoso.com",
      "StrongAuthenticationRequirements": [
        {
          "State": "Enforced"
        }
      ],
      "StrongAuthenticationMethods": [
        {
          "MethodType": "AuthenticatorApp",
          "IsDefault": true
        }
      ],
      "AssignedRoles": [
        {
          "DisplayName": "Global Administrator"
        }
      ]
    },
    "RuleId": ".\\Essential8.E8-7.AzureAD.MFA.PhishingResistant"
  }
]
