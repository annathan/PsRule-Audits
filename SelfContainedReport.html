<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Essential 8 Explicit Compliance Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; color: #333; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        
        .header { background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); color: white; padding: 40px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 300; }
        .header .subtitle { font-size: 1.1em; opacity: 0.9; margin-bottom: 20px; }
        .header .meta { font-size: 0.9em; opacity: 0.8; }
        
        .summary-section { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .summary-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; text-align: center; }
        .summary-card h3 { font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; opacity: 0.8; }
        .summary-card .value { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
        
        .findings-section { padding: 30px; }
        .finding-card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 4px solid #ddd; }
        .finding-card.passed { border-left-color: #28a745; }
        .finding-card.failed { border-left-color: #dc3545; }
        .finding-card.warning { border-left-color: #ffc107; }
        
        .finding-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .finding-title { font-size: 1.1em; font-weight: 600; color: #2c3e50; }
        .finding-status { padding: 4px 8px; border-radius: 15px; font-size: 0.8em; font-weight: bold; text-transform: uppercase; }
        .finding-status.passed { background: #d4edda; color: #155724; }
        .finding-status.failed { background: #f8d7da; color: #721c24; }
        .finding-status.warning { background: #fff3cd; color: #856404; }
        
        .finding-details { margin-top: 15px; }
        .finding-detail { margin-bottom: 10px; }
        .finding-detail strong { color: #495057; }
        .finding-detail pre { background: #f8f9fa; padding: 10px; border-radius: 4px; font-size: 0.9em; overflow-x: auto; }
        
        .severity-badge { padding: 2px 6px; border-radius: 10px; font-size: 0.7em; font-weight: bold; text-transform: uppercase; }
        .severity-badge.high { background: #f8d7da; color: #721c24; }
        .severity-badge.medium { background: #fff3cd; color: #856404; }
        .severity-badge.low { background: #d1ecf1; color: #0c5460; }
        
        .report-meta { background: #e9ecef; padding: 20px; text-align: center; font-size: 0.9em; color: #6c757d; }
        
        .loading { text-align: center; padding: 40px; }
        .error { background: #f8d7da; color: #721c24; padding: 20px; border-radius: 5px; margin: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Essential 8 Explicit Compliance Report</h1>
            <div class="subtitle">Verifiable Rule-Based Security Assessment</div>
            <div class="meta" id="generatedAt">Loading...</div>
        </div>
        
        <div class="summary-section">
            <h2>üìä Compliance Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3>Total Checks</h3>
                    <div class="value" id="totalChecks">-</div>
                </div>
                <div class="summary-card">
                    <h3>Passed</h3>
                    <div class="value" style="color: #2ecc71;" id="passed">-</div>
                </div>
                <div class="summary-card">
                    <h3>Failed</h3>
                    <div class="value" style="color: #e74c3c;" id="failed">-</div>
                </div>
                <div class="summary-card">
                    <h3>Warnings</h3>
                    <div class="value" style="color: #f39c12;" id="warnings">-</div>
                </div>
                <div class="summary-card">
                    <h3>Compliance Score</h3>
                    <div class="value" id="complianceScore">-</div>
                </div>
            </div>
        </div>
        
        <div class="findings-section">
            <h2>üîç Detailed Findings</h2>
            <div id="findingsContainer">
                <div class="loading">Loading findings...</div>
            </div>
        </div>
        
        <div class="report-meta">
            <div id="source">Loading...</div>
            <div id="recordCount">Loading...</div>
        </div>
    </div>
    
    <script>
        // Embedded evaluation data
        const evaluationData = {
            "report": {
                "generatedAt": "2025-10-03T11:00:11Z",
                "source": "Essential 8 Compliance Assessment",
                "inputRecords": 2,
                "rulesEvaluated": 7
            },
            "summary": {
                "totalChecks": 14,
                "passed": 4,
                "failed": 2,
                "warning": 8,
                "complianceScore": 28.6
            },
            "findings": [
                {
                    "status": "warning",
                    "ruleId": "MFA-State-001",
                    "remediation": "Enable MFA for all user accounts in Azure AD.",
                    "severity": "high",
                    "targetPath": "$.StrongAuthenticationRequirements[0].State",
                    "title": "MFA enabled for user",
                    "evaluationResult": "Value comparison: expected 'Enforced', got 'null'",
                    "evidence": "{\"RelyingParty\":\"*\",\"State\":\"Enforced\"}",
                    "whyItMatters": "MFA reduces account takeover risk by requiring additional authentication factors."
                },
                {
                    "status": "failed",
                    "ruleId": "MFA-Methods-002",
                    "remediation": "Configure Authenticator app, FIDO2, or Windows Hello for Business as MFA methods.",
                    "severity": "high",
                    "targetPath": "$.StrongAuthenticationMethods",
                    "title": "Phishing-resistant MFA methods configured",
                    "evaluationResult": "Array length check: expected >= 1, got 0",
                    "evidence": "[]",
                    "whyItMatters": "Phishing-resistant methods prevent SMS-based attacks and provide stronger security."
                },
                {
                    "status": "warning",
                    "ruleId": "MFA-MethodType-003",
                    "remediation": "Enable Microsoft Authenticator app as an MFA method for users.",
                    "severity": "medium",
                    "targetPath": "$.StrongAuthenticationMethods[*].MethodType",
                    "title": "Authenticator app method available",
                    "evaluationResult": "Array contains check: looking for 'AuthenticatorApp' in []",
                    "evidence": "[]",
                    "whyItMatters": "Authenticator apps provide better security than SMS-based MFA."
                },
                {
                    "status": "warning",
                    "ruleId": "Admin-Roles-004",
                    "remediation": "Review and properly assign administrative roles to users.",
                    "severity": "medium",
                    "targetPath": "$.AssignedRoles",
                    "title": "User has administrative roles",
                    "evaluationResult": "Type check: expected 'array', got 'unknown'",
                    "evidence": "\"\"",
                    "whyItMatters": "Administrative roles should be properly assigned and monitored."
                },
                {
                    "status": "passed",
                    "ruleId": "Account-Status-005",
                    "remediation": "Ensure user accounts are properly enabled for access.",
                    "severity": "low",
                    "targetPath": "$.AccountEnabled",
                    "title": "User account is enabled",
                    "evaluationResult": "Value comparison: expected 'true', got 'true'",
                    "evidence": "true",
                    "whyItMatters": "Enabled accounts can be used for authentication and access."
                },
                {
                    "status": "warning",
                    "ruleId": "Global-Admin-Count-006",
                    "remediation": "Limit Global Administrator role assignments to 2-5 accounts maximum.",
                    "severity": "high",
                    "targetPath": "$.Members",
                    "title": "Global Administrator count within limits",
                    "evaluationResult": "Array length check failed: value is not an array",
                    "evidence": "Path not found: $.Members",
                    "whyItMatters": "Too many Global Administrators increases security risk and attack surface."
                },
                {
                    "status": "passed",
                    "ruleId": "User-Principal-Name-007",
                    "remediation": "Ensure all users have valid User Principal Names configured.",
                    "severity": "medium",
                    "targetPath": "$.UserPrincipalName",
                    "title": "User Principal Name is valid",
                    "evaluationResult": "Value exists: \"Andrew@camnetcyber.au\"",
                    "evidence": "\"Andrew@camnetcyber.au\"",
                    "whyItMatters": "Valid UPN is required for user identification and authentication."
                },
                {
                    "status": "warning",
                    "ruleId": "MFA-State-001",
                    "remediation": "Enable MFA for all user accounts in Azure AD.",
                    "severity": "high",
                    "targetPath": "$.StrongAuthenticationRequirements[0].State",
                    "title": "MFA enabled for user",
                    "evaluationResult": "Value comparison: expected 'Enforced', got 'null'",
                    "evidence": "{\"RelyingParty\":\"*\",\"State\":\"Enforced\"}",
                    "whyItMatters": "MFA reduces account takeover risk by requiring additional authentication factors."
                },
                {
                    "status": "failed",
                    "ruleId": "MFA-Methods-002",
                    "remediation": "Configure Authenticator app, FIDO2, or Windows Hello for Business as MFA methods.",
                    "severity": "high",
                    "targetPath": "$.StrongAuthenticationMethods",
                    "title": "Phishing-resistant MFA methods configured",
                    "evaluationResult": "Array length check: expected >= 1, got 0",
                    "evidence": "[]",
                    "whyItMatters": "Phishing-resistant methods prevent SMS-based attacks and provide stronger security."
                },
                {
                    "status": "warning",
                    "ruleId": "MFA-MethodType-003",
                    "remediation": "Enable Microsoft Authenticator app as an MFA method for users.",
                    "severity": "medium",
                    "targetPath": "$.StrongAuthenticationMethods[*].MethodType",
                    "title": "Authenticator app method available",
                    "evaluationResult": "Array contains check: looking for 'AuthenticatorApp' in []",
                    "evidence": "[]",
                    "whyItMatters": "Authenticator apps provide better security than SMS-based MFA."
                },
                {
                    "status": "warning",
                    "ruleId": "Admin-Roles-004",
                    "remediation": "Review and properly assign administrative roles to users.",
                    "severity": "medium",
                    "targetPath": "$.AssignedRoles",
                    "title": "User has administrative roles",
                    "evaluationResult": "Type check: expected 'array', got 'unknown'",
                    "evidence": "\"\"",
                    "whyItMatters": "Administrative roles should be properly assigned and monitored."
                },
                {
                    "status": "passed",
                    "ruleId": "Account-Status-005",
                    "remediation": "Ensure user accounts are properly enabled for access.",
                    "severity": "low",
                    "targetPath": "$.AccountEnabled",
                    "title": "User account is enabled",
                    "evaluationResult": "Value comparison: expected 'true', got 'true'",
                    "evidence": "true",
                    "whyItMatters": "Enabled accounts can be used for authentication and access."
                },
                {
                    "status": "warning",
                    "ruleId": "Global-Admin-Count-006",
                    "remediation": "Limit Global Administrator role assignments to 2-5 accounts maximum.",
                    "severity": "high",
                    "targetPath": "$.Members",
                    "title": "Global Administrator count within limits",
                    "evaluationResult": "Array length check failed: value is not an array",
                    "evidence": "Path not found: $.Members",
                    "whyItMatters": "Too many Global Administrators increases security risk and attack surface."
                },
                {
                    "status": "passed",
                    "ruleId": "User-Principal-Name-007",
                    "remediation": "Ensure all users have valid User Principal Names configured.",
                    "severity": "medium",
                    "targetPath": "$.UserPrincipalName",
                    "title": "User Principal Name is valid",
                    "evaluationResult": "Value exists: \"info@camnetcyber.au\"",
                    "evidence": "\"info@camnetcyber.au\"",
                    "whyItMatters": "Valid UPN is required for user identification and authentication."
                }
            ]
        };
        
        // Initialize the report
        function initializeReport() {
            try {
                // Bind report metadata
                document.getElementById('generatedAt').textContent = 'Generated on ' + evaluationData.report.generatedAt;
                document.getElementById('source').textContent = 'Source: ' + evaluationData.report.source;
                document.getElementById('recordCount').textContent = 'Input Records: ' + evaluationData.report.inputRecords + ' | Rules Evaluated: ' + evaluationData.report.rulesEvaluated;
                
                // Bind summary values
                document.getElementById('totalChecks').textContent = evaluationData.summary.totalChecks;
                document.getElementById('passed').textContent = evaluationData.summary.passed;
                document.getElementById('failed').textContent = evaluationData.summary.failed;
                document.getElementById('warnings').textContent = evaluationData.summary.warning;
                document.getElementById('complianceScore').textContent = evaluationData.summary.complianceScore + '%';
                
                // Bind findings
                const findingsContainer = document.getElementById('findingsContainer');
                findingsContainer.innerHTML = '';
                
                evaluationData.findings.forEach(finding => {
                    const findingElement = document.createElement('div');
                    findingElement.className = `finding-card finding-card-${finding.status}`;
                    findingElement.innerHTML = `
                        <div class="finding-header">
                            <div class="finding-title">${finding.title}</div>
                            <div>
                                <span class="finding-status finding-status-${finding.status}">${finding.status}</span>
                                <span class="severity-badge severity-badge-${finding.severity}">${finding.severity}</span>
                            </div>
                        </div>
                        
                        <div class="finding-details">
                            <div class="finding-detail">
                                <strong>Why it matters:</strong> ${finding.whyItMatters}
                            </div>
                            <div class="finding-detail">
                                <strong>Evidence:</strong>
                                <pre>${finding.evidence}</pre>
                            </div>
                            <div class="finding-detail">
                                <strong>Evaluation Result:</strong> ${finding.evaluationResult}
                            </div>
                            <div class="finding-detail">
                                <strong>Remediation:</strong> ${finding.remediation}
                            </div>
                            <div class="finding-detail">
                                <strong>Target Path:</strong> <code>${finding.targetPath}</code>
                            </div>
                        </div>
                    `;
                    findingsContainer.appendChild(findingElement);
                });
                
                console.log('Essential 8 Explicit Compliance Report loaded successfully!');
                console.log('Data:', evaluationData);
                
            } catch (error) {
                console.error('Error initializing report:', error);
                document.getElementById('findingsContainer').innerHTML = '<div class="error">Error loading report data: ' + error.message + '</div>';
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeReport);
    </script>
</body>
</html>
